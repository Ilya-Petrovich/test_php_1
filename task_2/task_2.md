### Задание №2 ###

1.   Некоторые события нужно продавать с дополнительными типами билетов - льготный 
     и групповой, у которых будут свои цены и название.
     Имеется информация, что вероятно, будут другие типы билетов, 
     которые нужно будет добавить.
     Нужно уметь сохранять при заказе 2 дополнительных типа билета, 
     льготный и групповой в бд.
     **Задача** - Нормализовать таблицу учитывая добавленные типы билетов, 
     показать конечный вид таблицы. Объяснить свое решение.
2.   Часто посетители из одного заказа приходят не одновременно на события.
     Возникает необходимость проверять их билеты по отдельности.
     Для этого у каждого билета должен быть свой баркод.
     Если в одном заказе было куплено несколько билетов, 2 взрослых, 3 детских, 
     4 льготных - то должно быть 9 баркодов для каждого билета соответственно.
     **Задача** - Нормализовать таблицу, учитывая что у каждого билета свой баркод,
     показать конечный вид таблицы. Объяснить свое решение.

### Первоначальная таблица ###
id  | event_id  | event_date          | ticket_adult_price  | ticket_adult_quantity  | ticket_kid_price  | ticket_kid_quantity  | barcode   | user_id  | equal_price  | created
--- | --------- | ------------------- | ------------------- | ---------------------- | ----------------- | -------------------- | --------  | -------- | ------------ | -------------------
1   | 003       | 2021-08-21 13:00:00 | 700                 | 1                      | 450               | 0                    | 11111111  | 00451    | 700          | 2021-01-11 13:22:09
2   | 006       | 2021-07-29 18:00:00 | 1000                | 0                      | 800               | 2                    | 22222222  | 00364    | 1600         | 2021-01-12 16:62:08
3   | 003       | 2021-08-15 17:00:00 | 700                 | 4                      | 450               | 3                    | 33333333  | 00015    | 4150         | 2021-01-13 10:08:45

### Решение ###

Так как условие задачи не содержит явного указания на написание кода, то 
представляю решение в виде текстового описания варианта нормализации БД.

Нормализация БД требует создания дополнительных таблиц и связей между ними. 
Выполнение пунктов 1 и 2 задания по отдельности не имеет смысла, так как для 
нормализации БД потребуется создать таблицу со списком билетов, которая потребуется 
и для реализации пункта 1, и для реализации пункта 2. Поэтому более оптимальным 
вариантом я считаю выполнение нормализации с учётом требований обоих пунктов.

Для событий создаётcя отдельная таблица events. Не обусловлено заданием, но для 
хорошей нормализации будет полезным.
### events ###
id  | event_id  | event_date          
--- | --------- | ------------------- 
1   | 003       | 2021-08-21 13:00:00 
2   | 006       | 2021-07-29 18:00:00 
3   | 003       | 2021-08-15 17:00:00 

Так как у разных событий типы билетов отличаются и могут появиться новые типы билетов,
логично выделить их в отдельную таблицу.
связи:
     поле event_id -> поле event_id таблицы events (типы билетов относятся к конкретным событиям)
### ticket_types ###
id  | event_id  | type_name  | price 
--- | --------- | ---------- | ------
1   | 3         | взрослый   | 700   
2   | 3         | детский    | 450   
3   | 6         | взрослый   | 1000  
4   | 6         | детский    | 800   
5   | 6         | льготный   | 777   
6   | 6         | групповой  | 555   

Для добавления каждому билету отдельного баркода создадим отдельную таблицу для билетов.
связи:
     поле order_id -> поле id таблицы orders
     поле ticket_type -> поле id таблицы ticket_types     
### tickets ###
id  | order_id  | ticket_type  | barcode 
--- | --------- | ------------ | --------
1   | 1         | 1            | 11111111
2   | 2         | 4            | 22222222
3   | 2         | 4            | 33333333
4   | 3         | 1            | 44444444
5   | 3         | 1            | 55555555
6   | 3         | 1            | 66666666
7   | 3         | 1            | 77777777
8   | 3         | 2            | 88888888
9   | 3         | 2            | 99999999
10  | 3         | 2            | 12345678

После добавления новых таблиц и создания связей исходная таблица заказов примет следующий вид.
связи:
     поле event_id -> поле id таблицы events
### orders ###
id  | event_id  | user_id  | equal_price  | created
--- | --------- | -------- | ------------ | -------------------
1   | 1         | 00451    | 700          | 2021-01-11 13:22:09
2   | 2         | 00364    | 1600         | 2021-01-12 16:62:08
3   | 3         | 00015    | 4150         | 2021-01-13 10:08:45

Представленный вариант нормализации решает поставленную задачу, минимизирует дублирование
информации и уменьшает сложность отдельных таблиц.
